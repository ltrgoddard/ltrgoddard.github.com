<!DOCTYPE html> 
<html> 
	<head> 
		<title>Pearl in Modern English</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0">
		<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow' rel='stylesheet' type='text/css'>
		<link rel="stylesheet" type="text/css" href="pearl.css" />
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="jquery.touchSwipe.min.js"></script>
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

				  ga('create', 'UA-49524936-1', 'auto');
				    ga('send', 'pageview');

				    </script>
		<script>
		
		$(document).ready(function(){
			
			function post() {
				
				$('#numeral').html(group[caret]);
				$('#stanza1').html(group[caret+1]);
				$('#stanza2').html(group[caret+2]);
				$('#stanza3').html(group[caret+3]);
				$('#stanza4').html(group[caret+4]);
				$('#stanza5').html(group[caret+5]);
				
			}
			
			function postBox() {
				
				$('#stanza6').html(message);

			}
			
			function postXV6() {
				$('#stanza6').html('<div id="xv6">' + group[caret+6] + '</div>');
			}

			
			function go(direction) {
				
				if (direction == 1) {
			
					if (caret != 134 && caret != 98 && caret != 91) {
				 	
					 	caret = caret+7;
				 		$('#text').fadeOut(50);
						setTimeout(function() {
				 				
							post();
							postBox();
							$('#text').fadeIn(50);
					
			 			}, 50);
			 		}
					else if (caret == 91) {
					
		 				caret = caret+7;
						$('#text').fadeOut(50);
			 			setTimeout(function() {
				 				
							post();
				 			postXV6();
							$('#text').fadeIn(50);
									
		 				}, 50);
		 			}
					else if (caret == 98) {
					
						caret = caret+8;
					 	$('#text').fadeOut(50);
					 	setTimeout(function() {
				 				
							post();
							postBox();
							$('#text').fadeIn(50);
								
					 	}, 50);
					}
					else if (caret == 134) {
				 				
					 	post();
						postBox();
				 			
			 		}
				}
		 		
		 		else if (direction == 0) {
				 		
					if (caret != 0  && caret != 106) {
			
						caret = caret-7;
						$('#text').fadeOut(50);
						setTimeout(function() {
								
							post();
							postBox();
							$('#text').fadeIn(50);
							
						}, 50);
				 	}
			 		else if (caret == 106) {
			 			
				 		caret = caret-8;
				 		$('#text').fadeOut(50);
				 		setTimeout(function() {
				 				
							post();
				 			postXV6();
							$('#text').fadeIn(50);
								
			 			}, 50);
			 		}
					else if (caret == 0) {
				 			
			 			post();
						postBox();
						
			 		}
		 		}
		 		
		 		/*if (caret == 28) {
				 			
					$('#illustration').html('<img src="http://imgur.com/GAxu51A.jpg" width="280" height="280" />');
				}
				else if (caret == 35 || caret == 63) {
				 	
				 	$('#illustration').html('<img src="http://imgur.com/XXY492K.jpg" width="280" height="280" />');
				}
				else if (caret == 70 || caret == 98) {
				 	
				 	$('#illustration').html('<img src="http://imgur.com/fD9nQ3z.jpg" width="280" height="280" />');
				}
				else if (caret == 106) {
				 
				 	$('#illustration').html('<img src="http://imgur.com/V09TEnp.jpg" width="280" height="280" />');
				}*/

			}
			
			
			$.get('pearl.txt', function(raw) {
				
				stripped = raw.replace(/\n\n\n/g, '\n\n');
				data = stripped.replace(/\n/g, '<br />');
				group = data.split('<br /><br />');
				caret = 0;
				message = '<div id="message"><h2>About this translation</h2><p>The aim of this text is to provide as exact a translation of the poem as possible whilst following its rhyme scheme and alliterative structure&mdash;in the spirit of the <em>Pearl</em> poet\'s deliberate errors, I have included plenty of undeliberate ones. The Middle English poem itself can be found <a href="http://quod.lib.umich.edu/cgi/t/text/text-idx?c=cme;cc=cme;view=toc;idno=Pearl">here</a>, and cannot be bettered.<p></div>';
				$('#numeral').html(group[0]);
				$('#stanza1').html(group[1]);
				$('#stanza2').html(group[2]);
				$('#stanza3').html(group[3]);
				$('#stanza4').html(group[4]);
				$('#stanza5').html(group[5]);
				$('#stanza6').html(message);
				$('#illustration').html('<img src="http://i.cubeupload.com/iBH9r4.jpg" width="280" height="280" />');
				
				$(document).swipe( {
					
					swipeLeft:function(event, direction, distance, duration, fingerCount) { go(1); },
  					
  					swipeRight:function(event, direction, distance, duration, fingerCount) { go(0); }
				});
					
				$(document).keydown(function(e) {
    
					switch(e.which) {

				 		case 39: go(1);	break;
						
						case 37: go(0);
				 		
						default: return;
    					}
    					e.preventDefault();
    				
				});
					
			});
			
		});
		
		</script>
	</head>
	<body>
			<div id="header">
				<h1>Pearl</h1>
				<h2>in Modern English</h2><hr />
				<p>Use your arrow keys (&larr; and &rarr;) or swipe to navigate this Modern English translation of the 14th century dream vision <em>Pearl</em>, or <a href="pearl.txt">click here</a> to download a plain text version.</p>
			</div>
			<div id="illustration"></div>
			<div id="content">
			<div id="text">
			<div id="numeral"></div>
			<div class="column" id="column1">
				<p class="stanza" id="stanza1"></p>
				<p class="stanza" id="stanza2"></p>
			</div>
			<div class="column" id="column2">
				<p class="stanza" id="stanza3"></p>
				<p class="stanza" id="stanza4"></p>
			</div>
			<div class="column" id="column3">
				<p class="stanza" id="stanza5"></p>
			</div>
			</div>
			<div class="column" id="column4">
				<p class="stanza" id="stanza6"></p>
			</div>
			</div>
			<div id="credits"><em>Translation and illustrations by Kay Miller (<a href="mailto:k1immiller@gmail.com">k1immiller@gmail.com</a>), website by Kay Miller and Louis Goddard (<a href="http://twitter.com/ltrgoddard">@ltrgoddard</a>).</em></div>
	</body>
</html>
