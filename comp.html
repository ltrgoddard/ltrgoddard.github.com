<html>
	<head>
 		<title>Computational Prynne</title>
		<script src="https://apis.google.com/js/client.js?"></script>
	</head>
	<body onload = "login();">
		<div id="input">
			<textarea id="source" rows="25" cols="75"></textarea>
			<button id="submit" onclick="search();">Search</button>
		</div>
		<div id="output">
		</div>
		<div id="results">
		</div>
	</body>
	    		<script>

function login() {

	gapi.client.setApiKey("AIzaSyBWi6rHM4-tUAIuL3oXckjJN9V8yMXdtU8");
	gapi.client.load("books", "v1", function() { console.log("Loaded!"); });
}

function search() {

	var chunkSize = 5
	var counter = 0
	var source = document.getElementById("source").value.split(" ");
	var batch = gapi.client.newHttpBatch();

	while (counter + chunkSize <= source.length) {

		var chunk = source.slice(counter,counter+chunkSize);
		var searchTerm = "\"" + chunk.join(" ") + "\"";
		console.log(searchTerm);
		
		var request = function() {
			return gapi.client.books.volumes.list({"q": searchTerm});
		};
		
		batch.add(request);
		
		counter++;
	}
	
	//batch.execute(function(resp) { console.log(resp); });
}
		</script>
</html>
